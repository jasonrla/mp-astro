import{a as ft,r as k}from"./index.Be8AcK8B.js";var C={exports:{}},b={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y;function ct(){if(Y)return b;Y=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(r,n,u){var c=null;if(u!==void 0&&(c=""+u),n.key!==void 0&&(c=""+n.key),"key"in n){u={};for(var l in n)l!=="key"&&(u[l]=n[l])}else u=n;return n=u.ref,{$$typeof:e,type:r,key:c,ref:n!==void 0?n:null,props:u}}return b.Fragment=t,b.jsx=i,b.jsxs=i,b}var Z;function dt(){return Z||(Z=1,C.exports=ct()),C.exports}var Tt=dt(),lt=Symbol.for("preact-signals");function J(){if(w>1)w--;else{for(var e,t=!1;E!==void 0;){var i=E;for(E=void 0,T++;i!==void 0;){var r=i.o;if(i.o=void 0,i.f&=-3,!(8&i.f)&&K(i))try{i.c()}catch(n){t||(e=n,t=!0)}i=r}}if(T=0,w--,t)throw e}}var o=void 0;function Q(e){var t=o;o=void 0;try{return e()}finally{o=t}}var E=void 0,w=0,T=0,O=0;function X(e){if(o!==void 0){var t=e.n;if(t===void 0||t.t!==o)return t={i:0,S:e,p:o.s,n:void 0,t:o,e:void 0,x:void 0,r:t},o.s!==void 0&&(o.s.n=t),o.s=t,e.n=t,32&o.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=o.s,t.n=void 0,o.s.n=t,o.s=t),t}}function a(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=t?.watched,this.Z=t?.unwatched,this.name=t?.name}a.prototype.brand=lt;a.prototype.h=function(){return!0};a.prototype.S=function(e){var t=this,i=this.t;i!==e&&e.e===void 0&&(e.x=i,this.t=e,i!==void 0?i.e=e:Q(function(){var r;(r=t.W)==null||r.call(t)}))};a.prototype.U=function(e){var t=this;if(this.t!==void 0){var i=e.e,r=e.x;i!==void 0&&(i.x=r,e.e=void 0),r!==void 0&&(r.e=i,e.x=void 0),e===this.t&&(this.t=r,r===void 0&&Q(function(){var n;(n=t.Z)==null||n.call(t)}))}};a.prototype.subscribe=function(e){var t=this;return I(function(){var i=t.value,r=o;o=void 0;try{e(i)}finally{o=r}},{name:"sub"})};a.prototype.valueOf=function(){return this.value};a.prototype.toString=function(){return this.value+""};a.prototype.toJSON=function(){return this.value};a.prototype.peek=function(){var e=o;o=void 0;try{return this.value}finally{o=e}};Object.defineProperty(a.prototype,"value",{get:function(){var e=X(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(T>100)throw new Error("Cycle detected");this.v=e,this.i++,O++,w++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{J()}}}});function m(e,t){return new a(e,t)}function K(e){for(var t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function tt(e){for(var t=e.s;t!==void 0;t=t.n){var i=t.S.n;if(i!==void 0&&(t.r=i),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function et(e){for(var t=e.s,i=void 0;t!==void 0;){var r=t.p;t.i===-1?(t.S.U(t),r!==void 0&&(r.n=t.n),t.n!==void 0&&(t.n.p=r)):i=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=r}e.s=i}function x(e,t){a.call(this,void 0),this.x=e,this.s=void 0,this.g=O-1,this.f=4,this.W=t?.watched,this.Z=t?.unwatched,this.name=t?.name}x.prototype=new a;x.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===O))return!0;if(this.g=O,this.f|=1,this.i>0&&!K(this))return this.f&=-2,!0;var e=o;try{tt(this),o=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(i){this.v=i,this.f|=16,this.i++}return o=e,et(this),this.f&=-2,!0};x.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}a.prototype.S.call(this,e)};x.prototype.U=function(e){if(this.t!==void 0&&(a.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};x.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(x.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=X(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function D(e,t){return new x(e,t)}function it(e){var t=e.u;if(e.u=void 0,typeof t=="function"){w++;var i=o;o=void 0;try{t()}catch(r){throw e.f&=-2,e.f|=8,M(e),r}finally{o=i,J()}}}function M(e){for(var t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,it(e)}function vt(e){if(o!==this)throw new Error("Out-of-order effect");et(this),o=e,this.f&=-2,8&this.f&&M(this),J()}function g(e,t){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=t?.name}g.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{e()}};g.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,it(this),tt(this),w++;var e=o;return o=this,vt.bind(this,e)};g.prototype.N=function(){2&this.f||(this.f|=2,this.o=E,E=this)};g.prototype.d=function(){this.f|=8,1&this.f||M(this)};g.prototype.dispose=function(){this.d()};function I(e,t){var i=new g(e,t);try{i.c()}catch(n){throw i.d(),n}var r=i.d.bind(i);return r[Symbol.dispose]=r,r}var N={exports:{}},P={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G;function ht(){if(G)return P;G=1;var e=ft();function t(s,f){return s===f&&(s!==0||1/s===1/f)||s!==s&&f!==f}var i=typeof Object.is=="function"?Object.is:t,r=e.useState,n=e.useEffect,u=e.useLayoutEffect,c=e.useDebugValue;function l(s,f){var y=f(),j=r({inst:{value:y,getSnapshot:f}}),p=j[0].inst,$=j[1];return u(function(){p.value=y,p.getSnapshot=f,v(p)&&$({inst:p})},[s,y,f]),n(function(){return v(p)&&$({inst:p}),s(function(){v(p)&&$({inst:p})})},[s]),c(y),y}function v(s){var f=s.getSnapshot;s=s.value;try{var y=f();return!i(s,y)}catch{return!0}}function R(s,f){return f()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?R:l;return P.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,P}var H;function pt(){return H||(H=1,N.exports=ht()),N.exports}var yt=pt(),St=k.version.split(".").map(Number)[0],mt=Symbol.for(St>=19?"react.transitional.element":"react.element"),S,rt=Symbol.dispose||Symbol.for("Symbol.dispose");function q(e,t){var i=t.effect.S();return S=t,xt.bind(t,e,i)}function xt(e,t){t(),S=e}var V,U,B=function(){},wt=((V={o:0,effect:{s:void 0,c:function(){},S:function(){return B},d:function(){}},subscribe:function(){return B},getSnapshot:function(){return 0},S:function(){},f:function(){}})[rt]=function(){},V),gt=Promise.prototype.then.bind(Promise.resolve());function bt(){U||(U=gt(ot))}function ot(){var e;U=void 0,(e=S)==null||e.f()}var Et=typeof window<"u"?k.useLayoutEffect:k.useEffect;function nt(e){e===void 0&&(e=0),bt();var t=k.useRef();t.current==null&&(typeof window>"u"?t.current=wt:t.current=(function(r){var n,u,c,l,v=0,R=I(function(){u=this});return u.c=function(){v=v+1|0,l&&l()},(n={o:r,effect:u,subscribe:function(d){return l=d,function(){v=v+1|0,l=void 0,R()}},getSnapshot:function(){return v},S:function(){if(S!=null){var d=S.o,s=this.o;d==0&&s==0||d==0&&s==1?(S.f(),c=q(void 0,this)):d==1&&s==0||d==2&&s==0||(c=q(S,this))}else c=q(void 0,this)},f:function(){var d=c;c=void 0,d?.()}})[rt]=function(){this.f()},n})(e));var i=t.current;return yt.useSyncExternalStore(i.subscribe,i.getSnapshot,i.getSnapshot),i.S(),e===0&&Et(ot),i}Object.defineProperties(a.prototype,{$$typeof:{configurable:!0,value:mt},type:{configurable:!0,value:function(e){var t=e.data,i=nt(1);try{return t.value}finally{i.f()}}},props:{configurable:!0,get:function(){return{data:this}}},ref:{configurable:!0,value:null}});function Ut(e){return nt(e)}const st="mp-gravity-checkout-data",kt=()=>{if(typeof window>"u")return{email:"",firstName:"",lastName:"",phone:"",address:"",city:"",zipCode:""};try{const e=localStorage.getItem(st);if(e)return JSON.parse(e)}catch(e){console.error("Error loading checkout data from localStorage:",e)}return{email:"",firstName:"",lastName:"",phone:"",address:"",city:"",zipCode:""}},Ot=e=>{if(!(typeof window>"u"))try{localStorage.setItem(st,JSON.stringify(e))}catch(t){console.error("Error saving checkout data to localStorage:",t)}},A=m([{id:"e9f22c16-6adf-40ce-a11b-611914e75579",name:"Premium Wireless Headphones",price:350,image:"https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=200&q=80",quantity:1},{id:"e9f22c16-6adf-40ce-a11b-611914e75579",name:"Ergonomic Mouse",price:120,image:"https://images.unsplash.com/photo-1527864550417-7fd91fc51a46?w=200&q=80",quantity:1}]),h=m("personal"),F=m(kt());typeof window<"u"&&I(()=>{Ot(F.value)});const _=D(()=>A.value.reduce((e,t)=>e+t.price*t.quantity,0)),L=D(()=>_.value*.1),at=D(()=>_.value-L.value),ut=m(null),W=m(!1);m(!1);const z=m(null),_t=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),Rt=()=>{const e=_t();if(ut.value=e,z.value=`TRK-${Date.now().toString().slice(-8)}`,typeof window<"u")try{const t=JSON.parse(localStorage.getItem("valid_orders")||"[]");t.push(e),localStorage.setItem("valid_orders",JSON.stringify(t))}catch(t){console.error("Error saving valid order:",t)}return e},jt=()=>{W.value=!0},$t=()=>{W.value=!1},Ct=async e=>{try{const t={id:e,trackingCode:z.value,customer:F.value,items:A.value,totals:{subtotal:_.value,discount:L.value,total:at.value},paymentStatus:"approved",paymentMethod:"tarjeta_credito"},i=await fetch("/api/orders/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw new Error("Failed to submit order to backend");const r=await i.json();return console.log("Order submitted to backend:",r),r}catch(t){console.error("Error submitting order:",t)}},Nt=()=>{h.value==="personal"?h.value="delivery":h.value==="delivery"&&(h.value="payment")},Pt=()=>{h.value==="payment"?h.value="delivery":h.value==="delivery"&&(h.value="personal")},Jt=Object.freeze(Object.defineProperty({__proto__:null,cart:A,checkoutData:F,checkoutStep:h,closePaymentModal:$t,createOrder:Rt,discount:L,isPaymentModalOpen:W,nextStep:Nt,openPaymentModal:jt,orderId:ut,prevStep:Pt,submitOrderToBackend:Ct,subtotal:_,total:at,trackingCode:z},Symbol.toStringTag,{value:"Module"}));export{h as a,A as b,F as c,L as d,m as e,ut as f,$t as g,z as h,W as i,Tt as j,Ut as k,Jt as l,Nt as n,jt as o,Pt as p,_ as s,at as t};
